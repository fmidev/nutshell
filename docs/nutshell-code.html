
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>NutShell Code &#8212; NutShell 0.3 documentation</title>
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="shortcut icon" href="_static/nutshell-logo.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Demo" href="nutshell-demo.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
          <p class="logo"><a href="index.html">
            <img class="logo" src="_static/nutshell-logo-small.png" alt="Logo"/>
          </a></p>
        <div class="headertitle"><a
          href="index.html">NutShell 0.3 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="nutshell-demo.html" title="Demo"
             accesskey="P">previous</a> |
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-nutshell.nutshell">
<span id="nutshell-code"></span><h1>NutShell Code<a class="headerlink" href="#module-nutshell.nutshell" title="Permalink to this headline">¶</a></h1>
<div class="section" id="main-module-nutshell-nutshell">
<h2>Main module – nutshell.nutshell<a class="headerlink" href="#main-module-nutshell-nutshell" title="Permalink to this headline">¶</a></h2>
<p>This module contains ProductServer class, which receives product
requests and forwards them to product generators. A ProductServer
instance also manages disk resources defined in 
<a class="reference internal" href="nutshell-config.html#configuration"><span class="std std-ref">Configuration</span></a>.</p>
<p>The module uses <a class="reference internal" href="#module-nutshell.product" title="nutshell.product"><code class="xref any py py-mod docutils literal notranslate"><span class="pre">nutshell.product</span></code></a>  for defining products (<a class="reference internal" href="#nutshell.product.Info" title="nutshell.product.Info"><code class="xref any py py-class docutils literal notranslate"><span class="pre">nutshell.product.Info</span></code></a>) 
and <a class="reference internal" href="#module-nutshell.request" title="nutshell.request"><code class="xref any py py-mod docutils literal notranslate"><span class="pre">nutshell.request</span></code></a> for generating them using <a class="reference internal" href="#nutshell.request.Generator" title="nutshell.request.Generator"><code class="xref any py py-class docutils literal notranslate"><span class="pre">nutshell.request.Generator</span></code></a> .</p>
<p>HTTP server provided by <a class="reference internal" href="#module-nutshell.httpd" title="nutshell.httpd"><code class="xref any py py-mod docutils literal notranslate"><span class="pre">nutshell.httpd</span></code></a> essentially forwards
HTTP requests to <a class="reference internal" href="#nutshell.nutshell.ProductServer" title="nutshell.nutshell.ProductServer"><code class="xref any py py-class docutils literal notranslate"><span class="pre">nutshell.ProductServer</span></code></a>.</p>
<dl class="class">
<dt id="nutshell.nutshell.ProductServer">
<em class="property">class </em><code class="descclassname">nutshell.nutshell.</code><code class="descname">ProductServer</code><span class="sig-paren">(</span><em>conffile=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer" title="Permalink to this definition">¶</a></dt>
<dd><p>Service designed for generating image and data products served as files</p>
<dl class="method">
<dt id="nutshell.nutshell.ProductServer.ensure_output_dir">
<code class="descname">ensure_output_dir</code><span class="sig-paren">(</span><em>outdir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.ensure_output_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.ensure_output_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a writable directory, if non-existent</p>
<p>Currently, uses mask 777</p>
</dd></dl>

<dl class="classmethod">
<dt id="nutshell.nutshell.ProductServer.get_arg_parser">
<em class="property">classmethod </em><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><em>parser=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.get_arg_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Populates parser with options of this class</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.nutshell.ProductServer.get_cache_root">
<code class="descname">get_cache_root</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.get_cache_root"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.get_cache_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the abolute path (Path) to CACHE_ROOT directory.</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.nutshell.ProductServer.get_input_list">
<code class="descname">get_input_list</code><span class="sig-paren">(</span><em>product_info</em>, <em>directives</em>, <em>log</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.get_input_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.get_input_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for reading dynamic input configuration generated by input.sh.
directives determine how the product is generated.</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.nutshell.ProductServer.get_product_dir">
<code class="descname">get_product_dir</code><span class="sig-paren">(</span><em>product_info</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.get_product_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.get_product_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the directory containing product generator script 
(generate.sh) and possible configurations etc</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.nutshell.ProductServer.init_path">
<code class="descname">init_path</code><span class="sig-paren">(</span><em>dirname</em>, <em>verify=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.init_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.init_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand relative path to absolute, optionally check that exists.</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.nutshell.ProductServer.make_prod">
<code class="descname">make_prod</code><span class="sig-paren">(</span><em>pr</em>, <em>directives=None</em>, <em>TEST=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.make_prod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.make_prod" title="Permalink to this definition">¶</a></dt>
<dd><p>Main function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pr</strong><strong>[</strong><strong>nutshell.product.Info</strong><strong>]</strong> – description of the product</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutshell.nutshell.ProductServer.make_request">
<code class="descname">make_request</code><span class="sig-paren">(</span><em>product_info, actions=['MAKE'], directives=None, log=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.make_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.make_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Main function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>product_info</strong> – description of the product (string or nutshell.product.Info)</li>
<li><strong>actions</strong> – what should be done about the product 
(<code class="docutils literal notranslate"><span class="pre">MAKE</span></code>, <code class="docutils literal notranslate"><span class="pre">DELETE</span></code>, <code class="docutils literal notranslate"><span class="pre">CHECK</span></code> , <code class="docutils literal notranslate"><span class="pre">RETURN</span></code>), see <a class="reference internal" href="nutshell-commands.html#commands"><span class="std std-ref">Commands and status codes</span></a> .</li>
<li><strong>directives</strong> – how the product is generated etc</li>
<li><strong>log</strong> – optional logging.logger</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Instance of product.Generator that contains the path of 
the file (if succefully generated) and information about the process.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutshell.nutshell.ProductServer.query_file">
<code class="descname">query_file</code><span class="sig-paren">(</span><em>pr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.query_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.query_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Main function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pr</strong><strong>[</strong><strong>nutshell.product.Info</strong><strong>]</strong> – description of the product (string or nutshell.product.Info)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutshell.nutshell.ProductServer.read_conf">
<code class="descname">read_conf</code><span class="sig-paren">(</span><em>conffile=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.read_conf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.read_conf" title="Permalink to this definition">¶</a></dt>
<dd><p>Read given conf file, if it exists. Raise error, if strict.
The entries are copied to respective member of self.</p>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-nutshell.httpd"></span><div class="section" id="http-server-nutshell-httpd">
<h2>HTTP Server – nutshell.httpd<a class="headerlink" href="#http-server-nutshell-httpd" title="Permalink to this headline">¶</a></h2>
<p>Server can be started with command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span>  <span class="o">-</span><span class="n">m</span> <span class="n">nutshell</span><span class="o">.</span><span class="n">httpd</span> <span class="o">-</span><span class="n">c</span> <span class="n">nutshell</span><span class="o">.</span><span class="n">cnf</span>
</pre></div>
</div>
<p>By default, it returns a status page (HTML) containing</p>
<ul class="simple">
<li>query form</li>
<li>error messages</li>
<li>product info</li>
<li>input info</li>
<li>server status</li>
</ul>
<dl class="class">
<dt id="nutshell.httpd.NutHandler">
<em class="property">class </em><code class="descclassname">nutshell.httpd.</code><code class="descname">NutHandler</code><span class="sig-paren">(</span><em>*args</em>, <em>directory=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/httpd.html#NutHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.httpd.NutHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Forwards a HTTP request to  nutshell.ProductServer instance</p>
<dl class="method">
<dt id="nutshell.httpd.NutHandler.do_GET">
<code class="descname">do_GET</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/httpd.html#NutHandler.do_GET"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.httpd.NutHandler.do_GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Main function. Receives the http request and sends a response.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="nutshell.httpd.NutHandler.parse_url">
<em class="property">static </em><code class="descname">parse_url</code><span class="sig-paren">(</span><em>url</em>, <em>data=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/httpd.html#NutHandler.parse_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.httpd.NutHandler.parse_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits url to path (str) and query data (dict)</p>
<p>An empty data dict is returned if query is empty.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="nutshell.httpd.run_http">
<code class="descclassname">nutshell.httpd.</code><code class="descname">run_http</code><span class="sig-paren">(</span><em>product_server</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/httpd.html#run_http"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.httpd.run_http" title="Permalink to this definition">¶</a></dt>
<dd><p>A convenience function for starting and stopping the HTTP server.</p>
</dd></dl>

</div>
<span class="target" id="module-nutshell.product"></span><div class="section" id="product-definitions-and-requests-nutshell-product">
<h2>Product definitions and requests – nutshell.product<a class="headerlink" href="#product-definitions-and-requests-nutshell-product" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="nutshell.product.Info">
<em class="property">class </em><code class="descclassname">nutshell.product.</code><code class="descname">Info</code><span class="sig-paren">(</span><em>product=None</em>, <em>filename=None</em>, <em>product_id=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores product information, especially <code class="docutils literal notranslate"><span class="pre">PRODUCT_ID</span></code>, 
<code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span></code> (if applicable), file <code class="docutils literal notranslate"><span class="pre">FORMAT</span></code>, 
and product-specific free parameters.</p>
<p><strong>Parameters</strong> handled as with Info.set_product(). Key parameters are 
mutually exclusive.</p>
<dl class="docutils">
<dt>Examples of allowed calls, with <code class="docutils literal notranslate"><span class="pre">Info</span> <span class="pre">=</span> <span class="pre">nutshell.product.Info</span></code> :</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Info</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;my.image.product.png&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Info</span><span class="p">(</span><span class="n">product_id</span><span class="o">=</span><span class="s2">&quot;my.image.product&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Info</span><span class="p">(</span><span class="s2">&quot;my.image.product&quot;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;SIZE&quot;</span><span class="p">:</span> <span class="s2">&quot;640,400&quot;</span><span class="p">})</span>
</pre></div>
</div>
</dd>
<dt>A plain string argument is ambiguous, and raises an exception:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Info</span><span class="p">(</span><span class="s2">&quot;my.image.product&quot;</span><span class="p">)</span>       <span class="c1"># Looks understandable, but...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Info</span><span class="p">(</span><span class="s2">&quot;my.image.product.jpeg&quot;</span><span class="p">)</span>  <span class="c1"># ... is this a product ID or file?</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Info</span><span class="p">(</span><span class="s2">&quot;my.image.product_.jpeg&quot;</span><span class="p">)</span> <span class="c1"># This could be parsed as a file.</span>
</pre></div>
</div>
</dd>
</dl>
<p>This class is essentially a string parser and storage for parsed variables.
It is technically independent of server configurations 
like system side paths. Especially, it does not check if 
product generation directories or scripts exist.</p>
<dl class="classmethod">
<dt id="nutshell.product.Info.get_arg_parser">
<em class="property">classmethod </em><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><em>parser=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.get_arg_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Populates parser with options of this class</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Info.set_format">
<code class="descname">set_format</code><span class="sig-paren">(</span><em>extension</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.set_format"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.set_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets file format (png, txt, pgm.gz, txt.zip, …).</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Info.set_id">
<code class="descname">set_id</code><span class="sig-paren">(</span><em>product_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.set_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.set_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the product ID string consisting of alphanumeric chars and periods.</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Info.set_parameter">
<code class="descname">set_parameter</code><span class="sig-paren">(</span><em>key</em>, <em>value=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.set_parameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.set_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Set any parameter, including FORMAT, excluding TIMESTAMP and ID</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> – name (string) of the parameter</li>
<li><strong>value</strong> – the value of the parameter, possibly not 
string but hopefully stringifiable</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Info.set_parameters">
<code class="descname">set_parameters</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.set_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.set_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a dictionary of parameters, set values.</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Info.set_product">
<code class="descname">set_product</code><span class="sig-paren">(</span><em>product=None</em>, <em>filename=None</em>, <em>product_id=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.set_product"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.set_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure a product.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>product</strong> – product id string, requires explicit kwargs</li>
<li><strong>product_id</strong> – product id string.</li>
<li><strong>filename</strong> – product description presented as a filename</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">instance (possibly incomplete, to be adjusted with separate 
method calls)</p>
</td>
</tr>
</tbody>
</table>
<p>See <span class="xref std std-ref">Info</span>. Parameters equivalent at initialisation.</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Info.set_timestamp">
<code class="descname">set_timestamp</code><span class="sig-paren">(</span><em>timestamp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.set_timestamp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.set_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Set UTC time in numeric format ‘%Y%m%d%H%M’, ‘LATEST’, or ‘TIMESTAMP’</p>
<p>The 12 digit-numeric format may contain punctuation as long as the
order of the time units is not changed.
Non-digits will be simply removed.
For example, 2020/03/29 18:45 is pruned to 202003291845.
Consequently, possible <em>time zones</em> will be also discarded.</p>
<p>Future versions may support for time object, unix seconds and date string parsing.</p>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-nutshell.request"></span><div class="section" id="product-requests-nutshell-request">
<h2>Product requests – nutshell.request<a class="headerlink" href="#product-requests-nutshell-request" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="nutshell.request.Generator">
<em class="property">class </em><code class="descclassname">nutshell.request.</code><code class="descname">Generator</code><span class="sig-paren">(</span><em>product_server</em>, <em>product_info</em>, <em>log=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/request.html#Generator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.request.Generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for storing information on requested product and server side resources derived thereof.</p>
<dl class="method">
<dt id="nutshell.request.Generator.get_input_list">
<code class="descname">get_input_list</code><span class="sig-paren">(</span><em>directives</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/request.html#Generator.get_input_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.request.Generator.get_input_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for reading dynamic input configuration generated by input.sh.
directives determine how the product is generated.</p>
</dd></dl>

<dl class="attribute">
<dt id="nutshell.request.Generator.path">
<code class="descname">path</code><em class="property"> = PosixPath('/tmp')</em><a class="headerlink" href="#nutshell.request.Generator.path" title="Permalink to this definition">¶</a></dt>
<dd><p>System-side full path to a dynamic directory and the generated product file.</p>
</dd></dl>

<dl class="attribute">
<dt id="nutshell.request.Generator.path_static">
<code class="descname">path_static</code><em class="property"> = PosixPath('/tmp')</em><a class="headerlink" href="#nutshell.request.Generator.path_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional: System-side full path to the generated product file.</p>
</dd></dl>

<dl class="attribute">
<dt id="nutshell.request.Generator.path_tmp">
<code class="descname">path_tmp</code><em class="property"> = PosixPath('/tmp')</em><a class="headerlink" href="#nutshell.request.Generator.path_tmp" title="Permalink to this definition">¶</a></dt>
<dd><p>Futue extension: resulting object (for example, python Image)</p>
</dd></dl>

<dl class="attribute">
<dt id="nutshell.request.Generator.product_info">
<code class="descname">product_info</code><em class="property"> = None</em><a class="headerlink" href="#nutshell.request.Generator.product_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Specification of a product instance.</p>
</dd></dl>

<dl class="attribute">
<dt id="nutshell.request.Generator.product_server">
<code class="descname">product_server</code><em class="property"> = None</em><a class="headerlink" href="#nutshell.request.Generator.product_server" title="Permalink to this definition">¶</a></dt>
<dd><p>Server assigned for manufacturing this product</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.request.Generator.remove_files">
<code class="descname">remove_files</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/request.html#Generator.remove_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.request.Generator.remove_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the existing (even empty) files, log as info().</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.request.Generator.set_status">
<code class="descname">set_status</code><span class="sig-paren">(</span><em>status</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/request.html#Generator.set_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.request.Generator.set_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Set success or failure status using http.HTTPStatus codes.
Setting is logged.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutshell.request.InputQuery">
<em class="property">class </em><code class="descclassname">nutshell.request.</code><code class="descname">InputQuery</code><span class="sig-paren">(</span><em>product_server</em>, <em>product_info</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/request.html#InputQuery"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.request.InputQuery" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="nutshell.request.Tasklet">
<em class="property">class </em><code class="descclassname">nutshell.request.</code><code class="descname">Tasklet</code><span class="sig-paren">(</span><em>product_server</em>, <em>product_info</em>, <em>script_filename</em>, <em>log=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/request.html#Tasklet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.request.Tasklet" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for shell operations (<a class="reference internal" href="#nutshell.request.InputQuery" title="nutshell.request.InputQuery"><code class="xref any py py-class docutils literal notranslate"><span class="pre">InputQuery</span></code></a> and <a class="reference internal" href="#nutshell.request.Generator" title="nutshell.request.Generator"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>)</p>
</dd></dl>

</div>
<span class="target" id="module-nutshell.shell"></span><div class="section" id="escape-from-python-nutshell-shell">
<h2>Escape from Python – nutshell.shell<a class="headerlink" href="#escape-from-python-nutshell-shell" title="Permalink to this headline">¶</a></h2>
<p>This module contains utilities for running shell scripts.</p>
<dl class="class">
<dt id="nutshell.shell.Task">
<em class="property">class </em><code class="descclassname">nutshell.shell.</code><code class="descname">Task</code><span class="sig-paren">(</span><em>script</em>, <em>env=None</em>, <em>log=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/shell.html#Task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.shell.Task" title="Permalink to this definition">¶</a></dt>
<dd><p>Something that has a script, stdin, stdout, env, and log.</p>
<dl class="method">
<dt id="nutshell.shell.Task.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>logfile_basename=None</em>, <em>logfile_level=40</em>, <em>directives=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/shell.html#Task.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.shell.Task.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a task object containing task.script and task.stdout</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>logfile_basename</strong> – Leading part of logs, ‘.err’ and ‘.out’ will be added.</li>
<li><strong>logfile_level</strong> – Save stderr and stdout to logs, if
this threshold is at least logging.ERROR and logging.DEBUG, respecively</li>
<li><strong>directives</strong><strong>[</strong><strong>dict</strong><strong>]</strong> – Additional instructions to the script</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Return code of the process. Will be also stored to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-nutshell.nutils"></span><div class="section" id="utilities-nutshell-nutils">
<h2>Utilities – nutshell.nutils<a class="headerlink" href="#utilities-nutshell-nutils" title="Permalink to this headline">¶</a></h2>
<p>Utilities for handling objects and configuration files.</p>
<dl class="function">
<dt id="nutshell.nutils.debug_dict">
<code class="descclassname">nutshell.nutils.</code><code class="descname">debug_dict</code><span class="sig-paren">(</span><em>d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutils.html#debug_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutils.debug_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>dictionary to a string.</p>
</dd></dl>

<dl class="function">
<dt id="nutshell.nutils.dict_str">
<code class="descclassname">nutshell.nutils.</code><code class="descname">dict_str</code><span class="sig-paren">(</span><em>d</em>, <em>format='  {0}=&quot;{1}&quot;\n'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutils.html#dict_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutils.dict_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a dictionary to a string.</p>
</dd></dl>

<dl class="function">
<dt id="nutshell.nutils.get_entries">
<code class="descclassname">nutshell.nutils.</code><code class="descname">get_entries</code><span class="sig-paren">(</span><em>obj</em>, <em>regexp=None</em>, <em>dst_type=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutils.html#get_entries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutils.get_entries" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets member values as a dictionary</p>
</dd></dl>

<dl class="function">
<dt id="nutshell.nutils.make_subdirs">
<code class="descclassname">nutshell.nutils.</code><code class="descname">make_subdirs</code><span class="sig-paren">(</span><em>rootdir</em>, <em>subdir=None</em>, <em>mode=493</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutils.html#make_subdirs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutils.make_subdirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a writable directory, if non-existent
:param rootdir[pathlike]: 
:param subdir[str]: 
currently, uses mask 777</p>
</dd></dl>

<dl class="function">
<dt id="nutshell.nutils.print_dict">
<code class="descclassname">nutshell.nutils.</code><code class="descname">print_dict</code><span class="sig-paren">(</span><em>d</em>, <em>format='  {0}=&quot;{1}&quot;\n'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutils.html#print_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutils.print_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump a dictionary to stdout.</p>
</dd></dl>

<dl class="function">
<dt id="nutshell.nutils.read_conf">
<code class="descclassname">nutshell.nutils.</code><code class="descname">read_conf</code><span class="sig-paren">(</span><em>path</em>, <em>result=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutils.html#read_conf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutils.read_conf" title="Permalink to this definition">¶</a></dt>
<dd><p>Read plain-text configuration file consisting of &lt;key&gt;=&lt;value&gt; pairs.</p>
</dd></dl>

<dl class="function">
<dt id="nutshell.nutils.read_conf_text">
<code class="descclassname">nutshell.nutils.</code><code class="descname">read_conf_text</code><span class="sig-paren">(</span><em>text</em>, <em>result=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutils.html#read_conf_text"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutils.read_conf_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Traverse array of text lines consisting of &lt;key&gt;=&lt;value&gt; pairs.</p>
</dd></dl>

<dl class="function">
<dt id="nutshell.nutils.set_entries">
<code class="descclassname">nutshell.nutils.</code><code class="descname">set_entries</code><span class="sig-paren">(</span><em>obj</em>, <em>entries=None</em>, <em>lenient=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutils.html#set_entries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutils.set_entries" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a dictionary, sets corresponding member values</p>
</dd></dl>

</div>
<div class="section" id="module-nutshell.nutxml">
<span id="html-utilities-nutshell-nutxml"></span><h2>HTML utilities – nutshell.nutxml<a class="headerlink" href="#module-nutshell.nutxml" title="Permalink to this headline">¶</a></h2>
<p>Utilities for main modules of NutShell</p>
<dl class="class">
<dt id="nutshell.nutxml.KeyValueRowGenerator">
<em class="property">class </em><code class="descclassname">nutshell.nutxml.</code><code class="descname">KeyValueRowGenerator</code><a class="reference internal" href="_modules/nutshell/nutxml.html#KeyValueRowGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutxml.KeyValueRowGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Tool for generating elements that display &lt;key&gt;=&lt;value&gt; pairs for example as table rows or list items.</p>
<dl class="classmethod">
<dt id="nutshell.nutxml.KeyValueRowGenerator.get">
<em class="property">classmethod </em><code class="descname">get</code><span class="sig-paren">(</span><em>entry</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutxml.html#KeyValueRowGenerator.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutxml.KeyValueRowGenerator.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Entry should be an array or tuple.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="nutshell.nutxml.get_by_id">
<code class="descclassname">nutshell.nutxml.</code><code class="descname">get_by_id</code><span class="sig-paren">(</span><em>html</em>, <em>id</em>, <em>tag='span'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutxml.html#get_by_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutxml.get_by_id" title="Permalink to this definition">¶</a></dt>
<dd><p>tag: if create</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="nutshell-overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="nutshell-usage.html">Using NutShell</a></li>
<li class="toctree-l1"><a class="reference internal" href="nutshell-commands.html">Commands and status codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="nutshell-config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="nutshell-generators.html">Product generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="nutshell-variables.html">NutShell Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="nutshell-demo.html">Demo</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">NutShell Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#main-module-nutshell-nutshell">Main module – nutshell.nutshell</a></li>
<li class="toctree-l2"><a class="reference internal" href="#http-server-nutshell-httpd">HTTP Server – nutshell.httpd</a></li>
<li class="toctree-l2"><a class="reference internal" href="#product-definitions-and-requests-nutshell-product">Product definitions and requests – nutshell.product</a></li>
<li class="toctree-l2"><a class="reference internal" href="#product-requests-nutshell-request">Product requests – nutshell.request</a></li>
<li class="toctree-l2"><a class="reference internal" href="#escape-from-python-nutshell-shell">Escape from Python – nutshell.shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="#utilities-nutshell-nutils">Utilities – nutshell.nutils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutshell.nutxml">HTML utilities – nutshell.nutxml</a></li>
</ul>
</li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="nutshell-demo.html" title="Demo"
              >previous</a> |
            <a href="py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/nutshell-code.rst.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Markus Peura.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>