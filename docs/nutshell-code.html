<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>NutShell Code &mdash; NutShell 0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/nutshell-logo.ico"/>
    <link rel="top" title="NutShell 0.2 documentation" href="index.html" />
    <link rel="prev" title="NutShell Variables" href="variables.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
          <p class="logo"><a href="index.html">
            <img class="logo" src="_static/nutshell-logo-small.png" alt="Logo"/>
          </a></p>
        <div class="headertitle"><a
          href="index.html">NutShell 0.2 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="variables.html" title="NutShell Variables"
             accesskey="P">previous</a> |
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="nutshell-code">
<h1>NutShell Code<a class="headerlink" href="#nutshell-code" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-nutshell.nutshell">
<span id="main-module-nutshell"></span><h2>Main module &#8211; NutShell<a class="headerlink" href="#module-nutshell.nutshell" title="Permalink to this headline">¶</a></h2>
<p>Product generator service appicable on the command line or as a library</p>
<div class="section" id="command-line-usage">
<span id="id1"></span><h3>Command line usage<a class="headerlink" href="#command-line-usage" title="Permalink to this headline">¶</a></h3>
<p>Basic format for all the command line invocations is:</p>
<div class="highlight-python"><div class="highlight"><pre>python3 -m nutshell.nutshell &lt;nutshell-args&gt;
</pre></div>
</div>
<p>Online help is optained with <code class="docutils literal"><span class="pre">-h</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>python3 -m nutshell.nutshell -h
</pre></div>
</div>
<p>Simple query using configuration file and product definition:</p>
<div class="highlight-python"><div class="highlight"><pre>python3 -m nutshell.nutshell -c nutshell/nutshell.cnf -m \
  -p 201708121500_radar.rack.comp_SIZE=800,800_SITES=fiika_BBOX=20,62,30,70.png 
</pre></div>
</div>
<p>More details in <a href="#id8"><span class="problematic" id="id9">`Overall Scheme`_</span></a></p>
</div>
<div class="section" id="using-nutshell-within-python">
<h3>Using NutShell within python<a class="headerlink" href="#using-nutshell-within-python" title="Permalink to this headline">¶</a></h3>
<p>Simple example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">nutshell.nutshell</span> <span class="kn">as</span> <span class="nn">nuts</span>

<span class="c1"># Initilize service</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">nuts</span><span class="o">.</span><span class="n">ProductServer</span><span class="p">(</span><span class="s1">&#39;nutshell/nutshell.cnf&#39;</span><span class="p">)</span>

<span class="c1"># Retrieve / generate a product</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">make_request</span><span class="p">(</span><span class="s2">&quot;201708121600_radar.rack.comp_SITES=fikor,fivan,fiika_SIZE=800,800.png&quot;</span><span class="p">,</span> <span class="s2">&quot;MAKE&quot;</span><span class="p">)</span>

<span class="c1"># Results:</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Return code: {0} &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">returncode</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Status (HTTP code): {0}:  &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;File path: {0} &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>

<span class="c1"># Example: further processing (image data)</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="nb">file</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">file</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="status-codes">
<h3>Status codes<a class="headerlink" href="#status-codes" title="Permalink to this headline">¶</a></h3>
<p>NutShell recycles some standard HTTP status codes <a class="footnote-reference" href="#id4" id="id2">[1]</a> <a class="footnote-reference" href="#id5" id="id3">[2]</a> for 
communicating success or failure on operations. 
Many of those codes can be also used by the generator scripts
in describing errors or other exceptional conditions back 
to the hosting system, NutShell.</p>
<div class="section" id="useful-http-codes">
<h4>Useful HTTP codes<a class="headerlink" href="#useful-http-codes" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="33%" />
<col width="13%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Code</th>
<th class="head">Standard Enum Name</th>
<th class="head">NutShell</th>
<th class="head">Comment</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>102</td>
<td>PROCESSING</td>
<td>x</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>200</td>
<td>OK</td>
<td>x</td>
<td>Request completed successfully</td>
</tr>
<tr class="row-even"><td>404</td>
<td>Not Found</td>
<td>x</td>
<td>Document not found</td>
</tr>
<tr class="row-odd"><td>405</td>
<td>Method Not Allowed</td>
<td>x</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>409</td>
<td>Conflict</td>
<td>&nbsp;</td>
<td>Contradicting parameters</td>
</tr>
<tr class="row-odd"><td>413</td>
<td>Payload Too Large</td>
<td>&nbsp;</td>
<td>Parameters imply expensive computation</td>
</tr>
<tr class="row-even"><td>415</td>
<td>Unsupported Media Type</td>
<td>&nbsp;</td>
<td>Unsupported file format</td>
</tr>
<tr class="row-odd"><td>416</td>
<td>Range Not Satisfiable</td>
<td>&nbsp;</td>
<td>Parameter underflow or overflow</td>
</tr>
<tr class="row-even"><td>425</td>
<td>Too Early</td>
<td>&nbsp;</td>
<td>Input data not arrived</td>
</tr>
<tr class="row-odd"><td>501</td>
<td>Not Implemented</td>
<td>x</td>
<td>Product generator not found</td>
</tr>
<tr class="row-even"><td>503</td>
<td>Service Unavailable</td>
<td>x</td>
<td>Busy, come back later</td>
</tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td><a class="reference external" href="https://docs.python.org/3/library/http.html">https://docs.python.org/3/library/http.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td><a class="reference external" href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html</a></td></tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="code-documentation">
<h3>Code documentation<a class="headerlink" href="#code-documentation" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nutshell.nutshell.ProductServer">
<em class="property">class </em><code class="descclassname">nutshell.nutshell.</code><code class="descname">ProductServer</code><span class="sig-paren">(</span><em>conffile=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer" title="Permalink to this definition">¶</a></dt>
<dd><p>Service designed for generating image and data products served as files</p>
<dl class="method">
<dt id="nutshell.nutshell.ProductServer.ensure_output_dir">
<code class="descname">ensure_output_dir</code><span class="sig-paren">(</span><em>outdir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.ensure_output_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.ensure_output_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a writable directory, if non-existent</p>
</dd></dl>

<dl class="classmethod">
<dt id="nutshell.nutshell.ProductServer.get_arg_parser">
<em class="property">classmethod </em><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><em>parser=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.get_arg_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Populates parser with options of this class</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.nutshell.ProductServer.get_input_list">
<code class="descname">get_input_list</code><span class="sig-paren">(</span><em>product_info</em>, <em>directives</em>, <em>log</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.get_input_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.get_input_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for reading dynamic input configuration generated by input.sh.
directives determine how the product is generated.</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.nutshell.ProductServer.get_product_dir">
<code class="descname">get_product_dir</code><span class="sig-paren">(</span><em>product_info</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.get_product_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.get_product_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns directory containing product generator script (generate.sh) and possible configurations etc</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.nutshell.ProductServer.init_path">
<code class="descname">init_path</code><span class="sig-paren">(</span><em>dirname</em>, <em>verify=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.init_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.init_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand relative path to absolute, optionally check that exists.</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.nutshell.ProductServer.make_request">
<code class="descname">make_request</code><span class="sig-paren">(</span><em>product_info, actions=['MAKE'], directives=None, log=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutshell.html#ProductServer.make_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutshell.ProductServer.make_request" title="Permalink to this definition">¶</a></dt>
<dd><p>&#8221; Return path or log
&#8216;MAKE&#8217;   - return the product, if in cache, else generate it and return
&#8216;DELETE&#8217; - delete the product in cache
&#8216;INPUTS&#8217; - generate and store the product, also regenerate even if already exists</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-nutshell.httpd">
<span id="http-server-nutshell-httpd"></span><h2>HTTP Server &#8211; nutshell.httpd<a class="headerlink" href="#module-nutshell.httpd" title="Permalink to this headline">¶</a></h2>
<p>NutShell HTTP server</p>
<p>Server can be started with command:</p>
<div class="highlight-python"><div class="highlight"><pre>python3  -m nutshell.httpd -c nutshell.cnf
</pre></div>
</div>
<ul class="simple">
<li>query form</li>
<li>error messages</li>
<li>product info</li>
<li>input info</li>
<li>server status</li>
</ul>
<dl class="class">
<dt id="nutshell.httpd.NutHandler">
<em class="property">class </em><code class="descclassname">nutshell.httpd.</code><code class="descname">NutHandler</code><span class="sig-paren">(</span><em>request</em>, <em>client_address</em>, <em>server</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/httpd.html#NutHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.httpd.NutHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Forwards a HTTP request to  nutshell.ProductServer instance</p>
<dl class="staticmethod">
<dt id="nutshell.httpd.NutHandler.get_html_template">
<em class="property">static </em><code class="descname">get_html_template</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/httpd.html#NutHandler.get_html_template"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.httpd.NutHandler.get_html_template" title="Permalink to this definition">¶</a></dt>
<dd><p>Read HTML template dir and return it for modifications.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="nutshell.httpd.NutHandler.parse_url">
<em class="property">static </em><code class="descname">parse_url</code><span class="sig-paren">(</span><em>url</em>, <em>data=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/httpd.html#NutHandler.parse_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.httpd.NutHandler.parse_url" title="Permalink to this definition">¶</a></dt>
<dd><p>splitquery(&#8216;/path?query&#8217;) &#8211;&gt; &#8216;/path&#8217;, &#8216;query&#8217;.
If query returned also when None</p>
</dd></dl>

<dl class="staticmethod">
<dt id="nutshell.httpd.NutHandler.send_to_stream">
<em class="property">static </em><code class="descname">send_to_stream</code><span class="sig-paren">(</span><em>s</em>, <em>product_request</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/httpd.html#NutHandler.send_to_stream"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.httpd.NutHandler.send_to_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Send to stream</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="nutshell.httpd.run_http">
<code class="descclassname">nutshell.httpd.</code><code class="descname">run_http</code><span class="sig-paren">(</span><em>product_server</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/httpd.html#run_http"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.httpd.run_http" title="Permalink to this definition">¶</a></dt>
<dd><p>A function just for me.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>my_arg</strong> &#8211; The first of my arguments.</li>
<li><strong>my_other_arg</strong> &#8211; The second of my arguments.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A message (just for me, of course).</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-nutshell.product">
<span id="product-definitions-and-requests-nutshell-product"></span><h2>Product definitions and requests &#8211; nutshell.product<a class="headerlink" href="#module-nutshell.product" title="Permalink to this headline">¶</a></h2>
<p><strong>Product generator helper classes.</strong></p>
<div class="section" id="variable-parsing">
<h3>Variable parsing<a class="headerlink" href="#variable-parsing" title="Permalink to this headline">¶</a></h3>
<p>Parsing can be tested interactively:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nutshell.product</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">nutshell</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">Info</span><span class="p">(</span><span class="s2">&quot;201708121600_my.test.product_SIZE=300.pgm.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="main-variables">
<h4>Main variables<a class="headerlink" href="#main-variables" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="39%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Variable</th>
<th class="head">Description</th>
<th class="head">Example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">PRODUCT</span></code></td>
<td>Product id, eg.</td>
<td>&#8220;my.test.product&#8221;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">TIMESTAMP</span></code></td>
<td>Time attribute of a product</td>
<td>&#8220;201708121600&#8221;</td>
</tr>
<tr class="row-even"><td>&#8211; <code class="docutils literal"><span class="pre">YEAR</span></code></td>
<td>Year (4 digits)</td>
<td>&#8220;2017&#8221;</td>
</tr>
<tr class="row-odd"><td>&#8211; <code class="docutils literal"><span class="pre">MONTH</span></code></td>
<td>Month (2 digits)</td>
<td>&#8220;08&#8221;</td>
</tr>
<tr class="row-even"><td>&#8211; <code class="docutils literal"><span class="pre">DAY</span></code></td>
<td>Day (2 digits)</td>
<td>&#8220;12&#8221;</td>
</tr>
<tr class="row-odd"><td>&#8211; <code class="docutils literal"><span class="pre">HOUR</span></code></td>
<td>Hour (2 digits)</td>
<td>&#8220;16&#8221;</td>
</tr>
<tr class="row-even"><td>&#8211; <code class="docutils literal"><span class="pre">MINUTE</span></code></td>
<td>Minute (2 digits)</td>
<td>&#8220;00&#8221;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">PARAMETERS</span></code></td>
<td>Product specific variables</td>
<td>{&#8220;SIZE&#8221;: &#8220;300&#8221;, &#8220;NAME&#8221;: &#8220;X&#8221;}</td>
</tr>
<tr class="row-even"><td>&#8211; <code class="docutils literal"><span class="pre">&lt;KEY&gt;</span></code></td>
<td>Name of a variable</td>
<td>&#8220;300&#8221;</td>
</tr>
<tr class="row-odd"><td>&#8211; <code class="docutils literal"><span class="pre">&lt;KEY&gt;</span></code></td>
<td>Name of a variable</td>
<td>&#8220;X&#8221;</td>
</tr>
<tr class="row-even"><td>&#8211;  ...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">EXTENSION</span></code></td>
<td>File format,
including compression</td>
<td>&#8220;txt.gz&#8221;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">FORMAT</span></code></td>
<td>File format</td>
<td>&#8220;txt&#8221;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">COMPRESSION</span></code></td>
<td>File compression</td>
<td>&#8220;gz&#8221;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id6">
<h3>Code documentation<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nutshell.product.Generator">
<em class="property">class </em><code class="descclassname">nutshell.product.</code><code class="descname">Generator</code><span class="sig-paren">(</span><em>product_server</em>, <em>product_info</em>, <em>actions=None</em>, <em>directives=None</em>, <em>log=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Generator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for storing information on requested product and server side resources derived thereof.</p>
<dl class="attribute">
<dt id="nutshell.product.Generator.path">
<code class="descname">path</code><em class="property"> = ''</em><a class="headerlink" href="#nutshell.product.Generator.path" title="Permalink to this definition">¶</a></dt>
<dd><p>System-side full path to a dynamic directory and the generated product file.</p>
</dd></dl>

<dl class="attribute">
<dt id="nutshell.product.Generator.path_static">
<code class="descname">path_static</code><em class="property"> = ''</em><a class="headerlink" href="#nutshell.product.Generator.path_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional: System-side full path to the generated product file.</p>
</dd></dl>

<dl class="attribute">
<dt id="nutshell.product.Generator.path_tmp">
<code class="descname">path_tmp</code><em class="property"> = ''</em><a class="headerlink" href="#nutshell.product.Generator.path_tmp" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional: Actual object (for example, python Image in the future)</p>
</dd></dl>

<dl class="attribute">
<dt id="nutshell.product.Generator.product_info">
<code class="descname">product_info</code><em class="property"> = None</em><a class="headerlink" href="#nutshell.product.Generator.product_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Specification of a product instance.</p>
</dd></dl>

<dl class="attribute">
<dt id="nutshell.product.Generator.product_server">
<code class="descname">product_server</code><em class="property"> = None</em><a class="headerlink" href="#nutshell.product.Generator.product_server" title="Permalink to this definition">¶</a></dt>
<dd><p>Server assigned for manufacturing this product</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Generator.remove_files">
<code class="descname">remove_files</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Generator.remove_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Generator.remove_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the existing (even empty) files, log as info().</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Generator.set_status">
<code class="descname">set_status</code><span class="sig-paren">(</span><em>status</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Generator.set_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Generator.set_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Set success or failure status using http.HTTPStatus codes.
This is always logged.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutshell.product.Info">
<em class="property">class </em><code class="descclassname">nutshell.product.</code><code class="descname">Info</code><span class="sig-paren">(</span><em>product=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores basic product information: product id, timestamp (if applicable)
file format, and specific product parameters.</p>
<p>Technically independent of environment and other classes.
Does not store local information or configurations (system side paths etc.).</p>
<dl class="classmethod">
<dt id="nutshell.product.Info.get_arg_parser">
<em class="property">classmethod </em><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><em>parser=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.get_arg_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Populates parser with options of this class</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Info.get_param_env">
<code class="descname">get_param_env</code><span class="sig-paren">(</span><em>env=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.get_param_env"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.get_param_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Append or create dict with TIMESTAMP and params</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Info.parse_filename">
<code class="descname">parse_filename</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.parse_filename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.parse_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Derive product parameters from a filename.</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Info.set_format">
<code class="descname">set_format</code><span class="sig-paren">(</span><em>extension</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.set_format"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.set_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets file format (png, txt, pgm.gz, txt.zip, ...).</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Info.set_id">
<code class="descname">set_id</code><span class="sig-paren">(</span><em>product_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.set_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.set_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the product ID string consisting of alphanumeric chars and periods.</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Info.set_parameter">
<code class="descname">set_parameter</code><span class="sig-paren">(</span><em>key</em>, <em>value=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.set_parameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.set_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Set any parameter, including FORMAT, excluding TIMESTAMP and ID</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><p class="first">key &#8211; a string identfying of a parameter or the product
value &#8211; the value of the parameter, possibly not</p>
<blockquote class="last">
<div>string but stringifiable</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Info.set_parameters">
<code class="descname">set_parameters</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.set_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.set_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a dictionary of parameters, set values.</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Info.set_product">
<code class="descname">set_product</code><span class="sig-paren">(</span><em>product_desc</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.set_product"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.set_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure a product.</p>
<p>Arguments:
product_desc &#8211; a product ID string or a filename
kwargs  &#8211; keyword arguments completing the product definition</p>
</dd></dl>

<dl class="method">
<dt id="nutshell.product.Info.set_timestamp">
<code class="descname">set_timestamp</code><span class="sig-paren">(</span><em>timestamp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/product.html#Info.set_timestamp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.product.Info.set_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Set UTC time in numeric format &#8216;%Y%m%d%H%M&#8217; or its punctuated variants.</p>
<p>Essentially, the timestamp will be stored as a string of 
12 digits, &#8220;202003291845&#8221; for example.</p>
<p>The numbers have to be in order year, month, day, hour, and minute.
Non-digits will be simply removed.
For example, 2020/03/29 18:45 is pruned to 202003291845.
Consequently, possible _time <a href="#id10"><span class="problematic" id="id11">zones_</span></a> will be also discarded.</p>
<p>Todo: support for time object, unix seconds and date string parsing.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-nutshell.shell">
<span id="escape-to-shell-nutshell-shell"></span><h2>Escape to shell &#8211; nutshell.shell<a class="headerlink" href="#module-nutshell.shell" title="Permalink to this headline">¶</a></h2>
<p>Product generator service appicable on the command line or as a library</p>
<div class="section" id="id7">
<h3>Code documentation<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nutshell.shell.Task">
<em class="property">class </em><code class="descclassname">nutshell.shell.</code><code class="descname">Task</code><span class="sig-paren">(</span><em>script</em>, <em>env=None</em>, <em>log=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/shell.html#Task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.shell.Task" title="Permalink to this definition">¶</a></dt>
<dd><p>Something that has a script and stdin, stdout, env and log</p>
<dl class="method">
<dt id="nutshell.shell.Task.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/shell.html#Task.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.shell.Task.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a task object containing task.script and task.stdout</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-nutshell.nutils">
<span id="utilities-nutshell-nutils"></span><h2>Utilities &#8211; nutshell.nutils<a class="headerlink" href="#module-nutshell.nutils" title="Permalink to this headline">¶</a></h2>
<p>Utilities for handling objects and configuration files.</p>
<dl class="class">
<dt id="nutshell.nutils.Log">
<em class="property">class </em><code class="descclassname">nutshell.nutils.</code><code class="descname">Log</code><span class="sig-paren">(</span><em>prefix='LOG: '</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutils.html#Log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutils.Log" title="Permalink to this definition">¶</a></dt>
<dd><p>Logging utility</p>
</dd></dl>

<dl class="function">
<dt id="nutshell.nutils.debug_dict">
<code class="descclassname">nutshell.nutils.</code><code class="descname">debug_dict</code><span class="sig-paren">(</span><em>d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutils.html#debug_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutils.debug_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>dictionary to a string.</p>
</dd></dl>

<dl class="function">
<dt id="nutshell.nutils.dict_str">
<code class="descclassname">nutshell.nutils.</code><code class="descname">dict_str</code><span class="sig-paren">(</span><em>d</em>, <em>format='  {0}=&quot;{1}&quot;\n'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutils.html#dict_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutils.dict_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a dictionary to a string.</p>
</dd></dl>

<dl class="function">
<dt id="nutshell.nutils.get_entries">
<code class="descclassname">nutshell.nutils.</code><code class="descname">get_entries</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutils.html#get_entries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutils.get_entries" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets member values as a dictionary</p>
</dd></dl>

<dl class="function">
<dt id="nutshell.nutils.print_dict">
<code class="descclassname">nutshell.nutils.</code><code class="descname">print_dict</code><span class="sig-paren">(</span><em>d</em>, <em>format='  {0}=&quot;{1}&quot;\n'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutils.html#print_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutils.print_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump a dictionary to stdout.</p>
</dd></dl>

<dl class="function">
<dt id="nutshell.nutils.read_conf_text">
<code class="descclassname">nutshell.nutils.</code><code class="descname">read_conf_text</code><span class="sig-paren">(</span><em>text</em>, <em>result={}</em>, <em>regexp='^([A-Za-z][\\w]*)=([^#]*)(#.*)?'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutils.html#read_conf_text"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutils.read_conf_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Read plain-text configuration file consisting of &lt;key&gt;=&lt;value&gt; pairs.</p>
</dd></dl>

<dl class="function">
<dt id="nutshell.nutils.set_entries">
<code class="descclassname">nutshell.nutils.</code><code class="descname">set_entries</code><span class="sig-paren">(</span><em>obj</em>, <em>entries={}</em>, <em>lenient=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutils.html#set_entries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutils.set_entries" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a dictionary, sets corresponding member values</p>
</dd></dl>

</div>
<div class="section" id="module-nutshell.nutxml">
<span id="html-utilities-nutshell-nutxml"></span><h2>HTML utilities &#8211; nutshell.nutxml<a class="headerlink" href="#module-nutshell.nutxml" title="Permalink to this headline">¶</a></h2>
<p>Utilities for main modules of NutShell</p>
<dl class="class">
<dt id="nutshell.nutxml.KeyValueRowGenerator">
<em class="property">class </em><code class="descclassname">nutshell.nutxml.</code><code class="descname">KeyValueRowGenerator</code><a class="reference internal" href="_modules/nutshell/nutxml.html#KeyValueRowGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutxml.KeyValueRowGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Tool for generating elements that display &lt;key&gt;=&lt;value&gt; pairs for example as table rows or list items.</p>
<dl class="classmethod">
<dt id="nutshell.nutxml.KeyValueRowGenerator.get">
<em class="property">classmethod </em><code class="descname">get</code><span class="sig-paren">(</span><em>entry</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutshell/nutxml.html#KeyValueRowGenerator.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutshell.nutxml.KeyValueRowGenerator.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Entry should be an array or tuple.</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="nutshell-main.html">Using NutShell</a></li>
<li class="toctree-l1"><a class="reference internal" href="commands.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="conf-file.html">Configuration file</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators.html">Product generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="variables.html">NutShell Variables</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">NutShell Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-nutshell.nutshell">Main module &#8211; NutShell</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#command-line-usage">Command line usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-nutshell-within-python">Using NutShell within python</a></li>
<li class="toctree-l3"><a class="reference internal" href="#status-codes">Status codes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-documentation">Code documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutshell.httpd">HTTP Server &#8211; nutshell.httpd</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutshell.product">Product definitions and requests &#8211; nutshell.product</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#variable-parsing">Variable parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">Code documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutshell.shell">Escape to shell &#8211; nutshell.shell</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id7">Code documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutshell.nutils">Utilities &#8211; nutshell.nutils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutshell.nutxml">HTML utilities &#8211; nutshell.nutxml</a></li>
</ul>
</li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
            <p class="searchtip" style="font-size: 90%">
                Enter search terms or a module, class or function name.
            </p>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="variables.html" title="NutShell Variables"
              >previous</a> |
            <a href="py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/nutshell-code.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &copy; Copyright 2020, Markus Peura.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>