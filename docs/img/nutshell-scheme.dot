digraph {

size="12,10";



node [shape=record, style=filled, fillcolor="white" ];




subgraph cluster0 {

  label = "Python Interpreter"
  bgcolor = "0.1 0.2 1.0" ; 
  
  HANDLER [label="NutShell", fillcolor="orange" ];

}

CMDLINE [label="Command Line Request", fillcolor="#80ff00"];
/* \n python3 -m nutshell.nutshell ... */
CMDLINE -> HANDLER;  /*  [label="MAKE\nDELETE\nCHECK" ]; */
CACHE -> CMDLINE;

HTTP [label="HTTP Request", fillcolor="#80ff00"]; /* \n http://server/nutshell/?product=... */
HTTP -> HTTP_HANDLER;
HTTP_HANDLER -> HTTP;
HTTP_HANDLER -> SHANDLER; /*  [label="MAKE\nDELETE\nCHECK" ]; */

subgraph cluster1 {

  label = "HTTP Server";
  bgcolor = "0.1 0.2 1.0"; /*"palegoldenrod"*/

  HTTP_HANDLER [label="HTTP request\n handler"];

  STATUS [label="{Status Page (HTML) }", fillcolor="white" ];
  /* - query form \l- error messages \l- product info \l- input info \l- server status \lc */

  SHANDLER [label="NutShell", fillcolor="orange" ];
  
}

subgraph cluster2 {

  label = "Python Program"
  bgcolor = "0.1 0.2 1.0" ; 

  PROGRAM [label="Main Program", fillcolor="#80ff00" ];

  PHANDLER [label="NutShell", fillcolor="orange" ];

  PROGRAM -> PHANDLER
  
}

STATUS -> HTTP_HANDLER;
/* STATUS:pinfo -> CACHE   [label="link", color="gray" ]; */
/* STATUS:iinfo -> CACHE   [label="link", color="gray" ]; */

HANDLER -> GENERATOR [label="" ];
SHANDLER -> GENERATOR [label="" ];
PHANDLER -> GENERATOR [label="" ];

GENERATOR -> CACHE [label="" ];

subgraph cluster3 {

  label = "Disk resources";
  bgcolor = "lightblue"; /* lightgray */

  CACHE [label="{Product cache | {prod1|prod2|prod3} }" ];

  GENERATOR [label="{Product generators | {prod1|prod2|prod3} }" ];

}

CACHE -> HTTP_HANDLER [label="" ];

{rank=same; CMDLINE HTTP }
/* {rank=same; HANDLER SHANDLER } */

}

